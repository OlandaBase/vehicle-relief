<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Olanda Base – 車両盗難支援のお願い / Vehicle Theft Relief</title>
  <style>
    body { font-family: system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,"Noto Sans JP","Yu Gothic",sans-serif; margin:0; color:#222; line-height:1.65; background:#fafafa; }
    header { padding: 1.5rem 1rem; background:#fff; border-bottom:2px solid #f26522; }
    .container{ max-width:1000px; margin:0 auto; padding:1rem; }
    h1,h2{ line-height:1.25; }
    .muted{ color:#666; } .small{ font-size:.95rem; }
    .btn{ padding:.4rem .7rem; border:1px solid #ccc; background:#fff; border-radius:6px; cursor:pointer; }
    .btn.active{ background:#222; color:#fff; border-color:#222; }
    .pill{ display:inline-block; padding:.25rem .6rem; border-radius:999px; background:#ebf5ff; color:#084298; border:1px solid #b6daff; font-size:.9rem; }
    .card{ background:#fff; border-radius:12px; padding:1rem 1.25rem; margin:1rem 0; box-shadow:0 1px 3px rgba(0,0,0,.06); }
    .grid{ display:grid; gap:1rem; grid-template-columns:1fr; } @media(min-width:900px){ .grid{ grid-template-columns:1.2fr .8fr; } }
    table{ border-collapse:collapse; width:100%; } th,td{ border:1px solid #e5e5e5; padding:.5rem; text-align:left; vertical-align:top; }
    .bank{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#f8f9fa; border:1px dashed #cfd4da; padding:.9rem; border-radius:8px; }
    .hidden{ display:none !important; }
    .progress-bar{ height:16px; background:#eee; border-radius:999px; overflow:hidden; border:1px solid #ddd; }
    .progress{ height:100%; width:0%; background:#2b8a3e; }
    ul{ margin:.4rem 0 .8rem 1.1rem; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div style="display:flex; gap:.5rem; align-items:center; flex-wrap:wrap;">
        <span class="muted">Language / 言語:</span>
        <button id="btn-ja" class="btn active">日本語</button>
        <button id="btn-en" class="btn">English</button>
        <span style="flex:1"></span>
        <span class="muted">Currency / 通貨:</span>
        <button id="btn-eur" class="btn active">EUR €</button>
        <button id="btn-jpy" class="btn">JPY ¥</button>
      </div>
      <h1 class="ja">Olanda Base – 車両盗難支援のお願い</h1>
      <h1 class="en hidden">Olanda Base – Vehicle Theft Relief</h1>
      <p class="muted small ja">被害届番号：<b id="pv-ja"></b>（フランス国家憲兵隊 / BTA Roussillon）</p>
      <p class="muted small en hidden">Police report ref: <b id="pv-en"></b> (Gendarmerie Nationale / BTA Roussillon)</p>
      <span class="pill ja">目標金額：<b><span data-money="goal" data-eur="33825"></span></b></span>
      <span class="pill en hidden">Goal: <b><span data-money="goal" data-eur="33825"></span></b></span>
    </div>
  </header>

  <main class="container grid">
    <section class="card">
      <h2 class="ja">進捗状況</h2><h2 class="en hidden">Progress</h2>
      <div style="display:flex; gap:1rem; flex-wrap:wrap; align-items:center;">
        <div class="pill"><span class="ja">現在の合計：</span><span class="en hidden">Raised:</span> <b><span data-money="raised"></span></b></div>
        <div class="pill"><span class="ja">支援者：</span><span class="en hidden">Supporters:</span> <b id="backers">0</b></div>
        <div class="pill"><span class="ja">達成率：</span><span class="en hidden">Progress:</span> <b id="pct">0%</b></div>
      </div>
      <div class="progress-bar" style="margin:.7rem 0 0;"><div class="progress" id="bar"></div></div>
      <p class="muted small ja">※ Googleシート（CSV公開）の合計を自動取得します。未設定時は 0% 表示になります。</p>
      <p class="muted small en hidden">* Automatically pulls totals from a published Google Sheet (CSV). If not set, displays 0%.</p>
    </section>

    <section class="card">
      <h2 class="ja">被害の概要</h2><h2 class="en hidden">Summary of Damages</h2>
      <p class="ja">
        2025年10月8日、フランス・Salaise-sur-Sanne にて、チーム車両 <b>Iveco Daily</b> と機材が盗難に遭いました。
        合計被害額は <b><span data-money="totalloss" data-eur="67650"></span></b>、当面の目標はその<strong>50%（<span data-money="goal" data-eur="33825"></span>）</strong>です。
        特に <b>自転車6台（1台 <span data-money="bike" data-eur="6000"></span>）＝ <span data-money="biketotal" data-eur="36000"></span></b> の損失が痛手です。
        正直、<b>悔しさ</b>と<b>腹立たしさ</b>は消えませんが、選手たちの挑戦を止めないために前を向きます。
      </p>
      <p class="en hidden">
        On 8 Oct 2025 in Salaise-sur-Sanne, France, our team vehicle (<b>Iveco Daily</b>) and equipment were stolen.
        The estimated total loss is <b><span data-money="totalloss" data-eur="67650"></span></b>; our immediate goal is
        <strong>50% (<span data-money="goal" data-eur="33825"></span>)</strong>. The biggest hit is
        <b>six race bikes (each <span data-money="bike" data-eur="6000"></span> → total <span data-money="biketotal" data-eur="36000"></span>)</b>.
        We are frustrated and angry, but we keep going.
      </p>

      <h3 class="ja">内訳（概算）</h3><h3 class="en hidden">Breakdown (est.)</h3>
      <table>
        <tr>
          <th class="ja">項目</th><th class="ja">数量</th><th class="ja">金額</th>
          <th class="en hidden">Item</th><th class="en hidden">Qty</th><th class="en hidden">Amount</th>
        </tr>
        <tr>
          <td class="ja">車両（Iveco Daily）</td><td>1</td><td><span data-money="v" data-eur="20000"></span></td>
          <td class="en hidden">Vehicle (Iveco Daily)</td><td class="en hidden">1</td><td class="en hidden"><span data-money="v" data-eur="20000"></span></td>
        </tr>
        <tr>
          <td class="ja">自転車</td><td>6</td><td><span data-money="biketotal" data-eur="36000"></span></td>
          <td class="en hidden">Bicycles</td><td class="en hidden">6</td><td class="en hidden"><span data-money="biketotal" data-eur="36000"></span></td>
        </tr>
        <tr>
          <td class="ja">機材・用品（既知の金額）</td><td>––</td><td><span data-money="equip_known" data-eur="6300"></span></td>
          <td class="en hidden">Equipment (known amounts)</td><td class="en hidden">––</td><td class="en hidden"><span data-money="equip_known" data-eur="6300"></span></td>
        </tr>
        <tr>
          <td class="ja">機材・用品（その他・確認中）</td><td>––</td><td><span data-money="equip_tbd" data-eur="5350"></span></td>
          <td class="en hidden">Equipment (additional, being confirmed)</td><td class="en hidden">––</td><td class="en hidden"><span data-money="equip_tbd" data-eur="5350"></span></td>
        </tr>
        <tr>
          <th class="ja">合計</th><th></th><th><span data-money="totalloss" data-eur="67650"></span></th>
          <th class="en hidden">Total</th><th></th><th class="en hidden"><span data-money="totalloss" data-eur="67650"></span></th>
        </tr>
      </table>
    </section>

    <aside class="card">
      <h2 class="ja">チーム紹介（Olanda Base）</h2><h2 class="en hidden">About Olanda Base</h2>
      <p class="ja">
        <b>Olanda Base</b> は、オランダを拠点に日本と欧州をつなぐ自転車競技プロジェクトです。シクロクロス／グラベル／XCM／パラサイクリングに取り組む選手の
        <b>遠征サポート・機材手配・ベース運営</b>を行っています。選手が欧州のレースを経験し、成長するための“拠点（Base）”を提供しています。
      </p>
      <p class="en hidden">
        <b>Olanda Base</b> is a Netherlands-based project connecting Japanese riders with European racing in CX, Gravel, XCM and Para-cycling.
        We provide a <b>base of operations, logistics, and equipment support</b> so athletes can race, learn and grow in Europe.
      </p>
      <ul class="ja">
        <li>活動拠点：オランダ</li>
        <li>主なカテゴリー：シクロクロス、グラベル、XCM、パラサイクリング</li>
        <li>ミッション：日本と欧州の“行き来”を当たり前にする</li>
      </ul>
      <ul class="en hidden">
        <li>Base: The Netherlands</li>
        <li>Focus: Cyclocross, Gravel, XCM, Para-cycling</li>
        <li>Mission: Make EU↔JP racing more accessible</li>
      </ul>
      <p class="small">公式サイト：<a href="https://sites.google.com/view/olandabase/page" target="_blank" rel="noopener">Olanda Base Official</a></p>

      <h3 class="ja">寄付方法（銀行／Wise）</h3><h3 class="en hidden">How to Donate (Bank / Wise)</h3>
      <h4 class="ja">🇪🇺 Wise（欧州の方におすすめ）</h4><h4 class="en hidden">🇪🇺 Wise (recommended for EU)</h4>
      <div class="bank">
        <div class="ja">
          <div><b>受取名義:</b> OlandaBase</div>
          <div><b>IBAN:</b> BE86 9677 0222 0550</div>
          <div><b>BIC / SWIFT:</b> TRWIBEB1XXX</div>
          <div><b>送金用途（Reference）:</b> Vehicle Theft Relief</div>
          <div class="muted">銀行名：Wise, Rue du Trône 100, 3rd floor, Brussels, 1050, Belgium</div>
        </div>
        <div class="en hidden">
          <div><b>Account name:</b> OlandaBase</div>
          <div><b>IBAN:</b> BE86 9677 0222 0550</div>
          <div><b>BIC / SWIFT:</b> TRWIBEB1XXX</div>
          <div><b>Reference:</b> Vehicle Theft Relief</div>
          <div class="muted">Bank: Wise, Rue du Trône 100, 3rd floor, Brussels, 1050, Belgium</div>
        </div>
      </div>

      <h4 class="ja">🇯🇵 日本国内振込</h4><h4 class="en hidden">🇯🇵 Japan bank transfer</h4>
      <div class="bank">
        <div class="ja">
          <div><b>銀行名:</b> 三井住友銀行（SMBC）</div>
          <div><b>支店名:</b> 356</div>
          <div><b>種別:</b> 普通</div>
          <div><b>口座番号:</b> 4742084</div>
          <div><b>名義:</b> カジテツキ</div>
          <div><b>振込メモ:</b> 盗難支援（お名前任意）</div>
        </div>
        <div class="en hidden">
          <div><b>Bank:</b> Sumitomo Mitsui Banking Corporation (SMBC)</div>
          <div><b>Branch:</b> 356</div>
          <div><b>Type:</b> Ordinary</div>
          <div><b>Account No.:</b> 4742084</div>
          <div><b>Account name:</b> カジテツキ</div>
          <div><b>Note:</b> “Vehicle Theft Relief” + your name (optional)</div>
        </div>
      </div>
    </aside>
  </main>

  <footer><div class="container"><p class="muted small">&copy; <span id="year"></span> Olanda Base Team</p></div></footer>

  <script>
    // ====== CONFIG ======
    const POLICE_REF = "02800/03342/2025";
    const GOAL_EUR = 33825;
    const TOTAL_LOSS_EUR = 67650;
    const EUR_TO_JPY = 165; // 表示用レート
    const SHEET_URL = "https://docs.google.com/spreadsheets/d/1-1KCbaKdikPAZHGne9EOaeolRPuAxkc7z8uLJDyrkzQ/edit?usp=drivesdk; "  // ← ここに Googleシート「ウェブに公開（CSV）」のURLを貼る
    // CSV 期待列: date,amount,currency,donor,status（大文字小文字は無視）
    // status が OK / CONFIRMED / CONFIRM / PAID の行だけ合計します

    // ====== Init text ======
    document.getElementById('pv-ja').textContent = POLICE_REF;
    document.getElementById('pv-en').textContent = POLICE_REF;
    document.getElementById('year').textContent = new Date().getFullYear();

    // ====== Language ======
    function setLang(lang){
      document.querySelectorAll('.ja').forEach(e=>e.classList.toggle('hidden', lang!=='ja'));
      document.querySelectorAll('.en').forEach(e=>e.classList.toggle('hidden', lang!=='en'));
      document.getElementById('btn-ja').classList.toggle('active', lang==='ja');
      document.getElementById('btn-en').classList.toggle('active', lang==='en');
      document.documentElement.lang = lang;
    }
    document.getElementById('btn-ja').onclick = ()=>setLang('ja');
    document.getElementById('btn-en').onclick = ()=>setLang('en');
    setLang('ja');

    // ====== Currency ======
    let ccy='EUR';
    function fmtEUR(n){ return '€'+Math.round(n).toLocaleString('en-US'); }
    function fmtJPY(n){ return '¥'+Math.round(n).toLocaleString('ja-JP'); }
    function toDisplay(n){ return ccy==='EUR' ? fmtEUR(n) : fmtJPY(n*EUR_TO_JPY); }
    function renderMoneyStatics(){
      document.querySelectorAll('[data-money]').forEach(el=>{
        const base = Number(el.getAttribute('data-eur')||0);
        el.textContent = toDisplay(base);
      });
    }
    document.getElementById('btn-eur').onclick = ()=>{ ccy='EUR'; document.getElementById('btn-eur').classList.add('active'); document.getElementById('btn-jpy').classList.remove('active'); renderMoneyStatics(); renderProgress(_eurSum,_backers); };
    document.getElementById('btn-jpy').onclick = ()=>{ ccy='JPY'; document.getElementById('btn-jpy').classList.add('active'); document.getElementById('btn-eur').classList.remove('active'); renderMoneyStatics(); renderProgress(_eurSum,_backers); };
    renderMoneyStatics();

    // ====== Progress (Sheet) ======
    let _eurSum = 0;
    let _backers = 0;

    function renderProgress(raisedEUR, backers){
      _eurSum = raisedEUR; _backers = backers || 0;
      const raisedEl = document.querySelector('[data-money="raised"]');
      if(raisedEl) raisedEl.textContent = toDisplay(raisedEUR);
      document.getElementById('backers').textContent = String(_backers);
      const pct = Math.min(100, Math.round((raisedEUR / GOAL_EUR) * 100)) || 0;
      document.getElementById('pct').textContent = pct + '%';
      document.getElementById('bar').style.width = pct + '%';
    }

    async function fetchSheet(){
      if(!SHEET_URL){ renderProgress(0,0); return; }
      try{
        const res = await fetch(SHEET_URL, {cache:'no-store'});
        const text = await res.text();
        const lines = text.trim().split(/\r?\n/);
        if(lines.length<=1){ renderProgress(0,0); return; }
        const header = lines.shift().split(',');
        const idx = {}; header.forEach((h,i)=>idx[h.trim().toLowerCase()] = i);
        const ai = idx['amount'], ci = idx['currency'], si = idx['status'];
        let eur = 0, count = 0;
        for(const line of lines){
          if(!line) continue;
          const cols = line.split(',');
          const raw = (cols[ai]||'').replace(/[^0-9.\-]/g,'');
          const amt = parseFloat(raw);
          const cur = (cols[ci]||'').trim().toUpperCase();
          const st  = (cols[si]||'').trim().toUpperCase();
          if(isNaN(amt) || amt<=0) continue;
          if(si!=null && st && !['OK','CONFIRMED','CONFIRM','PAID'].includes(st)) continue;
          if(cur==='EUR') eur += amt;
          else if(cur==='JPY') eur += amt / EUR_TO_JPY;
          count++;
        }
        renderProgress(eur, count);
      }catch(e){ console.error(e); renderProgress(0,0); }
    }
    fetchSheet();
    setInterval(fetchSheet, 10*60*1000); // 10分ごとに更新
  </script>
</body>
</html>
